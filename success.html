<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û–ø–ª–∞—Ç–∞ —É—Å–ø–µ—à–Ω–∞ - –ü–î–î –®–ø–∞—Ä–≥–∞–ª–∫–∏</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .container {
            max-width: 600px;
            margin-top: 50px;
        }
        .download-btn {
            background: #28a745;
            border: none;
            padding: 15px 30px;
            font-size: 1.2rem;
            transition: transform 0.2s;
        }
        .download-btn:hover {
            transform: scale(1.05);
        }
        .loading {
            display: none;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-light bg-white shadow-sm">
        <div class="container">
            <a class="navbar-brand" href="https://pdd-shpargalka.ru/index.html">
                ‚Üê –ù–∞–∑–∞–¥ –∫ —à–ø–∞—Ä–≥–∞–ª–∫–∞–º
            </a>
            <span class="navbar-text">
                üìö –ü–î–î –®–ø–∞—Ä–≥–∞–ª–∫–∏
            </span>
        </div>
    </nav>

    <div class="container text-center my-5">
        <div class="alert alert-success">
            <h1>‚úÖ –û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ!</h1>
        </div>
        
        <div id="loading" class="loading mb-3">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            </div>
            <p>–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤–∞—à–µ–π —à–ø–∞—Ä–≥–∞–ª–∫–∏...</p>
        </div>
        
        <div id="content">
            <p class="lead">–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–∫—É–ø–∫—É! –í–∞—à–∞ —à–ø–∞—Ä–≥–∞–ª–∫–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Å–∫–∞—á–∏–≤–∞–Ω–∏—é.</p>
            
            <!-- –ö–Ω–æ–ø–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è -->
            <div class="my-4">
                <button onclick="downloadPDF()" class="btn download-btn btn-lg">
                    üì• –°–∫–∞—á–∞—Ç—å PDF
                </button>
            </div>

            <div id="productInfo" class="mb-3">
                <!-- –°—é–¥–∞ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—Å—è –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ -->
            </div>

            <p class="text-muted small">
                –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ–º, —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏: <strong>support@pdd-shpargalka.ru</strong>
            </p>

            <div class="mt-4">
                <a href="https://pdd-shpargalka.ru/index.html" class="btn btn-outline-primary">–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a>
            </div>
        </div>
    </div>

    <footer class="bg-light py-4 mt-5">
        <div class="container text-center text-muted small">
            <p>üìß support@pdd-shpargalka.ru</p>
            <p class="mb-0"><a href="https://pdd-shpargalka.ru/policy.html" class="text-muted">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a></p>
        </div>
    </footer>

    <script>
        // –ù–∞–∑–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        const productNames = {
            '1': '–û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è –∏ —Ç–µ—Ä–º–∏–Ω—ã',
            '2': '–û–±–≥–æ–Ω –∏ –æ–ø–µ—Ä–µ–∂–µ–Ω–∏–µ', 
            '3': '–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —Å—Ç–æ—è–Ω–∫–∞',
            '4': '–ü—Ä–æ–µ–∑–¥ –ø–µ—Ä–µ–∫—Ä–µ—Å—Ç–∫–æ–≤',
            '5': '–°–∫–æ—Ä–æ—Å—Ç–Ω–æ–π —Ä–µ–∂–∏–º',
            '6': '–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –î–¢–ü',
            '7': '–°–≤–µ—Ç–æ–≤—ã–µ –∏ –∑–≤—É–∫–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã',
            '8': '–ü–µ—à–µ—Ö–æ–¥–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã',
            '9': '–ù–∞—á–∞–ª–æ –¥–≤–∏–∂–µ–Ω–∏—è –∏ –º–∞–Ω–µ–≤—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ',
            '10': '–ñ–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã–µ –ø–µ—Ä–µ–µ–∑–¥—ã',
            '11': '–û–±—â–∏–µ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏ –≤–æ–¥–∏—Ç–µ–ª—è'
        };

        // –°—Å—ã–ª–∫–∏ –Ω–∞ PDF —Ñ–∞–π–ª—ã (Google Drive)
        const pdfFiles = {
            '1': 'https://drive.google.com/file/d/1kYFSr6S_DGIE74yMo0v8EJMbH__r3O6D/view?usp=sharing',
            '2': 'https://drive.google.com/file/d/1GoBl8agPglK6Y0MbYubxueeYqLCOU2Ze/view?usp=sharing',
            '3': 'https://drive.google.com/file/d/1rhj9CIUO0TMuL0546bpgQSJQFeWRFs4s/view?usp=sharing',
            '4': 'https://drive.google.com/file/d/1Hh4sdwf9Mc1BL6cErskcQ2_Xi46w02Ri/view?usp=sharing',
            '5': 'https://drive.google.com/file/d/1W2VYr-yRUfeBCCLoLSvRIdxFcGG0GN9B/view?usp=sharing',
            '6': 'https://drive.google.com/file/d/1gDCXI0B0wE9UI7MOb0MSE1dRPzZ4QQrc/view?usp=sharing',
            '7': 'https://drive.google.com/file/d/12hShwoi5-5VVij3PPpu6WZdC_F2g3eqe/view?usp=sharing',
            '8': 'https://drive.google.com/file/d/18nWk92JVQTWx9UMWGysQQVhAYT38fnZk/view?usp=sharing',
            '9': 'https://drive.google.com/file/d/1-NXen5DEx00KKXCS2w8d3z0j-GAeCVRI/view?usp=sharing',
            '10': 'https://drive.google.com/file/d/1PyAOC7ZanERh22lcO49wuT1saouBCxXe/view?usp=sharing',
            '11': 'https://drive.google.com/file/d/1mNqgnOAnJFx69KMut87MMfxbjNPfZcDN/view?usp=sharing'
        };

        function getProductId() {
            // 1. –ü—Ä–æ–±—É–µ–º –∏–∑ URL (–æ—Å–Ω–æ–≤–Ω–æ–π —Å–ø–æ—Å–æ–± - —á–µ—Ä–µ–∑ customerNumber)
            const urlParams = new URLSearchParams(window.location.search);
            console.log('URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:', Object.fromEntries(urlParams.entries()));
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º customerNumber (–ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∏–∑ payment.html)
            let customerNumber = urlParams.get('customerNumber');
            console.log('customerNumber –∏–∑ URL:', customerNumber);
            
            if (customerNumber && customerNumber.startsWith('pdd_')) {
                const productId = customerNumber.replace('pdd_', '');
                console.log('–ù–∞–π–¥–µ–Ω product_id –∏–∑ customerNumber:', productId);
                return productId;
            }
            
            // 2. –ü—Ä–æ–±—É–µ–º –∏–∑ localStorage (—Ä–µ–∑–µ—Ä–≤–Ω—ã–π —Å–ø–æ—Å–æ–±)
            let productId = localStorage.getItem('last_paid_product');
            console.log('product_id –∏–∑ localStorage:', productId);
            
            if (productId) {
                localStorage.removeItem('last_paid_product');
                return productId;
            }
            
            // 3. –ü—Ä–æ–±—É–µ–º –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã URL
            productId = urlParams.get('product_id') || urlParams.get('product') || urlParams.get('label');
            
            if (productId) {
                console.log('–ù–∞–π–¥–µ–Ω product_id –∏–∑ –¥—Ä—É–≥–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:', productId);
                return productId;
            }
            
            // 4. Fallback - –ø–µ—Ä–≤—ã–π —Ç–æ–≤–∞—Ä
            console.log('–ù–µ –Ω–∞–π–¥–µ–Ω product_id, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback: 1');
            return '1';
        }

        function showProductInfo() {
            const productId = getProductId();
            const productInfo = document.getElementById('productInfo');
            
            console.log('–ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–∞:', productId);
            
            if (productNames[productId]) {
                productInfo.innerHTML = `
                    <div class="alert alert-info">
                        <strong>–í–∞—à–∞ —à–ø–∞—Ä–≥–∞–ª–∫–∞:</strong> ${productNames[productId]}
                    </div>
                `;
            } else {
                productInfo.innerHTML = `
                    <div class="alert alert-warning">
                        <strong>–®–ø–∞—Ä–≥–∞–ª–∫–∞ –ü–î–î</strong> (ID: ${productId})
                    </div>
                `;
            }
        }

        function downloadPDF() {
            const productId = getProductId();
            const pdfUrl = pdfFiles[productId];
            
            console.log('–°–∫–∞—á–∏–≤–∞–µ–º PDF –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–∞:', productId);
            console.log('URL PDF:', pdfUrl);
            
            if (pdfUrl) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
                document.getElementById('loading').style.display = 'block';
                document.getElementById('content').style.opacity = '0.5';
                
                // –û—Ç–∫—Ä—ã–≤–∞–µ–º PDF –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ
                const newWindow = window.open(pdfUrl, '_blank');
                
                // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('content').style.opacity = '1';
                }, 2000);
                
                // –§–æ–∫—É—Å –Ω–∞ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ
                if (newWindow) {
                    newWindow.focus();
                }
            } else {
                alert('–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω. –°–≤—è–∂–∏—Ç–µ—Å—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π: support@pdd-shpargalka.ru');
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            console.log('–°—Ç—Ä–∞–Ω–∏—Ü–∞ success.html –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            showProductInfo();
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∏–≤–∞–µ–º —á–µ—Ä–µ–∑ 1.5 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                console.log('–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ...');
                downloadPDF();
            }, 1500);
        });

        // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
        console.log('=== –û—Ç–ª–∞–¥–∫–∞ success.html ===');
        console.log('–¢–µ–∫—É—â–∏–π URL:', window.location.href);
        console.log('localStorage:', { 
            last_paid_product: localStorage.getItem('last_paid_product') 
        });
    </script>
</body>
</html>
